<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
            crossorigin="anonymous"
        />
    </head>
    <body>
        <h1>loading button</h1>
        <button id="loadBtn" class="btn btn-primary me-2">
            <!-- 클릭 -->
            <span class="spinner-border spinner-border-sm d-none"></span>
            <span class="button-text">데이터 로딩</span>
        </button>

        <button id="clearBtn" class="btn btn-danger me-2">
            <!-- 클릭 -->
            <span class="spinner-border spinner-border-sm d-none"></span>
            <span class="button-text">데이터 삭제</span>
        </button>

        <div id="result" class="mt-4"></div>

        <script>
            const loadBtn = document.getElementById('loadBtn');
            const spinner = loadBtn.querySelector('.spinner-border');
            const loadBtnText = loadBtn.querySelector('.button-text');
            const result = document.getElementById('result');

            loadBtn.addEventListener('click', async () => {
                spinner.classList.remove('d-none');
                loadBtnText.textContent = '로딩중..';
                loadBtn.disabled = true;
                const randomId = Math.floor(Math.random() * 10) + 1;
                await new Promise((resolve) => setTimeout(resolve, 1000));
                fetch(`https://jsonplaceholder.typicode.com/posts/${randomId}`)
                    .then((response) => response.json())
                    .then((json) => {
                        result.innerHTML = `
                        <div class="alert alert-success">
                            <h5>${json.title}</h5>
                            <p>${json.body}</p>
                        </div>
                        `;
                    })
                    .catch((e) => {
                        console.log(e);
                        result.innerHTML = `
                        <div class="alert alert-danger">
                            <h5>에러</h5>
                            <p>잠시후 다시 시도</p>
                        </div>
                        `;
                    })
                    .finally(() => {
                        loadBtn.disabled = false;
                        spinner.classList.add('d-none');
                        loadBtnText.textContent = '데이터 로딩';
                    });
            });

            const clearBtn = document.getElementById('clearBtn');
            const spinner2 = clearBtn.querySelector('.spinner-border');
            const clearBtnText = clearBtn.querySelector('.button-text');

            clearBtn.addEventListener('click', async () => {
                if (result.innerHTML === '') return;
                spinner2.classList.remove('d-none');
                clearBtnText.textContent = '삭제중..';
                clearBtn.disabled = true;
                await new Promise((resolve) => setTimeout(resolve, 1000));

                clearBtn.disabled = false;
                spinner2.classList.add('d-none');
                clearBtnText.textContent = '데이터 삭제';

                result.innerHTML = '';
            });
        </script>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"
        ></script>
    </body>
</html>
